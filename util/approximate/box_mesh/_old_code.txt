    ! Find the ordering of points starting at their closest to the center.
    CALL ARGSORT(distances, distance_indices)
    ! Reorder all points in order of distance from the center.
    pts(:,:) = pts(:,distance_indices)


    ! Compute the squared sums of all points.
    FORALL (idx=1:SIZE(pts,2)) sq_sums(idx) = SUM(pts(:,idx)**2)
    ! Find the 'center' of the data set.
    DO idx = 1, SIZE(pts,2)
       center(:) = center(:) + (pts(:,idx) - center(:)) / REAL(idx,REAL64)
    END DO
    ! Store the squared sum of the center point.
    ss = SUM(center(:)**2)
    ! Measure the distance between all points and the center.

    !$omp parallel do private(idx)
    DO idx = 1, SIZE(pts,2)
       distances(idx) = ss + sq_sums(idx) - 2 * DOT_PRODUCT(center(:), pts(:,idx))
    END DO
    !$omp end parallel do


